(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[591],{2e3:function(e,r,t){"use strict";var n=t(2809),a=t(5893),i=t(4645),o=t(4184),c=t.n(o),l=t(8506),s=t(4368),u=t.n(s);function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}r.Z=function(e){var r=e.className,t=e.enableMobile,o=void 0!==t&&t,s=(0,i.Z)(e,["className","enableMobile"]);return(0,a.jsx)(l.Z,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({className:c()(u().root,r),format:"leaderboard",sizesAt0:o?"mobile-wide":"",sizesAt976:"leaderboard",targetingPos:s.targetingPos||"leaderboard"},s))}},5394:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return be}});var n=t(809),a=t.n(n),i=t(2809),o=t(6213),c=t(266),l=t(2209),s=t(5893),u=t(6187),d=t(9094),f=t(4245),p=t(6695),y=t(8272),g=t(5152),b=t(9008),v=t(5989),m=t(1163),j=t(6333),h=t(8314),w=t(7294),O=t(5732),Z=t(7473),P=t(2820),x=t(8662),A=t(9926),C=t(1533),S=t(1627),D=t(7269),E=t(3232),_=t(1388),N=t(8483),k=t(8427),M=t(4390),T=t(6329),I=t(403),H=t(8409),$=t(825),B=t(2e3),q=t(4190);function X(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?X(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function L(e,r){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return R(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return R(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==t.return||t.return()}finally{if(c)throw i}}}}function R(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var F=(0,O.Z)((function(){return Promise.resolve().then(t.bind(t,1281))})),Q=(0,O.Z)((function(){return Promise.resolve().then(t.bind(t,1811))})),G=(0,O.Z)((function(){return t.e(198).then(t.bind(t,4198))})),U=function(e){var r,t,n,a;return(0,w.useEffect)((function(){if(e.embeds.length){var r,t=L(e.embeds);try{for(t.s();!(r=t.n()).done;){var n=r.value;if("script"===(null===n||void 0===n?void 0:n.type)){var a=document.createElement("script");a.type="text/javascript",a.src=n.src,document.body.appendChild(a)}}}catch(i){t.e(i)}finally{t.f()}}}),[e.embeds]),(0,s.jsxs)("main",{id:"main-content","data-category":"story page",children:[e.editorialProject&&(null===(r=e.editorialProject.river)||void 0===r||null===(t=r.edges)||void 0===t?void 0:t.length)>3?(0,s.jsx)(P.Z,z({},e.editorialProject)):(0,s.jsx)(B.Z,{}),(0,s.jsxs)(Z.Z,{layout:e.layout,children:[(0,s.jsxs)(x.Z,{children:["feature"===e.layout&&e.leadArt&&(0,s.jsx)(M.Z,z({layout:e.layout},e.leadArt)),(0,s.jsxs)(A.Z,{children:[(0,s.jsx)(E.Z,z({},e)),(0,s.jsx)(_.Z,z({},e)),(0,s.jsx)(N.Z,z({},e)),(0,s.jsx)(k.Z,z({},e))]}),"standard"===e.layout&&e.leadArt&&(0,s.jsx)(M.Z,z({layout:e.layout},e.leadArt)),(0,s.jsxs)(C.Z,z(z({},e),{},{children:[(0,s.jsx)(I.Z,z({},e)),(0,s.jsx)(H.Z,z({},e))]})),(0,s.jsxs)(S.Z,{borderBottom:!0,children:["ideas"===(null===(n=e.primaryChannel)||void 0===n?void 0:n.slug)&&"BlogArticle"===e.__typename&&(0,s.jsx)(T.Z,z({},e)),e.editorsNote&&(0,s.jsx)($.Z,z({},e.editorsNote))]})]}),(0,s.jsx)(D.Z,z({},e)),(0,s.jsxs)(S.Z,{children:[(null===(a=e.editorialProject)||void 0===a?void 0:a.foundationLineArticle)&&(0,s.jsx)(F,z({},e.editorialProject)),e.authors&&e.authors.map((function(r,t){return(0,s.jsx)(Q,z({index:t,reviews:e.reviews},r),r.displayName)}))]}),(0,s.jsx)(q.Z,{id:e.id.split(":")[1],preview:e.preview})]}),(0,s.jsx)(G,{})]})},V=t(2346),J=t(1389),K=t(3089),W=t(3320),Y=t(168),ee=t(8387),re=t(1281),te=t(1811);function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ie(){var e=(0,l.Z)(["\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n\n  query ArticleQuery($id: ID!, $preview: String) {\n    article(id: $id, preview: $preview) {\n      __typename\n      id\n      isTnfCompatible\n      datePublished\n      title\n      slug\n      wordCount\n      layout\n      isFreelance\n      isPython3\n      preview\n      watsonInfo {\n        topCategory {\n          full\n          one\n          two\n          three\n          four\n        }\n        categories\n      }\n      grapeshot {\n        segments\n      }\n      editorialProject {\n        slug\n        displayName\n        ...articleBentoRecircSwan\n        ...articleFoundationLineSwan\n      }\n      ...articleMetadata\n      ...articleRubric\n      ...articleTitle\n      ...articleSwanDek\n      ...articleTimestamp\n      ...articleBioSwan\n      ...aboutTheAuthors\n      ...articleBylines\n      ...articleJsonLdData\n      ...articleShare\n      ...articleBodyContent\n\n      leadArt {\n        ...articleLeadArtSwan\n      }\n      embeds {\n        type\n        src\n      }\n      primaryChannel {\n        slug\n        displayName\n      }\n      primaryCategory {\n        ... on Category {\n          slug\n        }\n        ... on Channel {\n          slug\n        }\n        ... on EditorialProject {\n          slug\n        }\n      }\n      categories {\n        slug\n      }\n      channels {\n        slug\n      }\n      editorsNote {\n        ...editorsNoteSwan\n      }\n      advertisingInfo {\n        disableHouseAd\n      }\n      ... on MagazineArticle {\n        issue {\n          issueName\n          slug\n        }\n      }\n    }\n  }\n"]);return ie=function(){return e},e}var oe=(0,d.Ps)(ie(),E.Z.fragment,_.Z.fragment,M.Z.fragment,$.Z.fragment,D.Z.fragment,te.default.fragment,J.Z.fragment,N.Z.fragment,k.Z.fragment,K.Z.fragment,W.Z.fragment,Y.Z.fragment,ee.Z.fragment,T.Z.fragment,I.Z.fragment,re.default.fragment,V.Z.fragment,P.Z.fragment,H.Z.fragment),ce=(0,g.default)((function(){return t.e(475).then(t.bind(t,6475))}),{loadableGenerated:{webpack:function(){return[6475]},modules:["../components/article/Article.tsx -> components/paywall/Paywall"]}}),le=(0,g.default)((function(){return t.e(284).then(t.bind(t,9284))}),{loadableGenerated:{webpack:function(){return[9284]},modules:["../components/article/Article.tsx -> components/NonMeteredNudge"]}}),se=function(e){var r,t=e.data,n=(0,v.aC)().hasPaywallAccess;return(0,h.Px)(t),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.default,{children:(0,s.jsxs)("title",{children:[t.article.seoTitle||t.article.title," - The Atlantic"]})}),(0,s.jsx)(J.Z,ae({},t.article)),(0,s.jsx)(V.Z,ae({},t.article)),(0,s.jsx)(j.s,{articleId:t.article.id.split(":")[1],previewParam:t.article.preview,primaryCategorySlug:(null===(r=t.article.primaryCategory)||void 0===r?void 0:r.slug)||"",children:(0,s.jsx)(U,ae({},t.article))}),t.article.hasMeter&&!n?(0,s.jsx)(ce,{}):(0,s.jsx)(le,ae({},t.article))]})},ue=function(){var e=(0,m.useRouter)().query,r=e.article,t=(0,o.Z)(r,4),n=(t[0],t[1],t[2],t[3]),a="string"===typeof e.preview?e.preview:null,i=(0,d.aM)({query:oe,variables:{id:n,preview:a}}),c=(0,o.Z)(i,1)[0],l=c.error,u=c.data;return l&&(0,p.nm)({error:l}),u?(0,s.jsx)(se,{data:u},"article-".concat(u.article.id)):null};function de(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function fe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?de(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function pe(){var e=(0,l.Z)(["\n  query ArticleInitialPropsQuery($id: ID!, $preview: String) {\n    article(id: $id, preview: $preview) {\n      id\n      isTnfCompatible\n      layout\n      hasMeter\n      url\n    }\n  }\n"]);return pe=function(){return e},e}var ye=function(){return(0,s.jsx)(u.Z,{analyticsCategory:"story page",children:(0,s.jsx)(ue,{})})},ge=(0,d.Ps)(pe());ye.getInitialProps=function(){var e=(0,c.Z)(a().mark((function e(r){var t,n,i,c,l,s,u,d,g,b,v,m,j,h,w,O,Z,P,x,A,C,S,D,E;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.urqlClient,i=r.query,c=r.req,l=r.res,s=i.article,u=(0,o.Z)(s,4),u[0],u[1],u[2],d=u[3],g=new RegExp(/^\/[a-z-]+\/archive\/\d{4}\/\d{2}\/[a-z\-\_\d]+\/\d+\/*($|\?)/i),null===c||void 0===c||!c.url){e.next=7;break}if(null===c||void 0===c||null===(b=c.url)||void 0===b?void 0:b.match(g)){e.next=7;break}throw new p.TX;case 7:return(v=parseInt(d,10))&&v<3e5&&"magazine"===i.channel&&(d="".concat(v+3e5)),m="string"===typeof i.preview?i.preview:null,e.next=12,n.query(ge,{id:d,preview:m}).toPromise();case 12:if(j=e.sent,l&&(l.setHeader("Surrogate-Key","article-id-".concat(d)),i.preview&&l.setHeader("Cache-Control","private, no-store, max-age=0")),!l||null===(t=j.data)||void 0===t||!t.article){e.next=26;break}return(O=[]).length&&(Z=l.getHeader("Vary"),P=Array.isArray(Z)?Z:"".concat(Z||"").split(",").map((function(e){return e.trim()})).filter(Boolean),O.forEach((function(e){P.push("X-Test-Bucket-".concat(e))})),l.setHeader("Vary",P.join(", "))),x=j.data.article,A=x.id.split(":")[1],C=(null===c||void 0===c||null===(h=c.url)||void 0===h?void 0:h.split("?")[1])||"",(0,y.Z)(fe({},j.data)),i.preview||(l.setHeader("Cache-Control","s-maxage=180"),l.setHeader("Surrogate-Control","max-age=180, stale-while-revalidate=86400, stale-if-error=259200")),x.hasMeter&&(l.setHeader("X-Is-Metered","1"),l.setHeader("X-Meter-Content",A),S=new Date,D=(0,f.MB)(S),l.setHeader("X-Meter-Expires",D.toUTCString())),E=x.url.split("theatlantic.com")[1],-1===(null===c||void 0===c||null===(w=c.url)||void 0===w?void 0:w.indexOf(E))&&(l.setHeader("Location","".concat(E).concat(C)),l.statusCode=302,l.end()),e.abrupt("return",{});case 26:return e.abrupt("return",{});case 27:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();var be=(0,d.du)(ye)},347:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[channel]/archive/[...article]",function(){return t(5394)}])},4368:function(e){e.exports={root:"Leaderboard_root__1RQA7"}}},function(e){var r=function(r){return e(e.s=r)};e.O(0,[774,28,16,185,681,629,683,972,888,179],(function(){return r(9484),r(347)}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=[...article]-05d0918a38dc01b50d71.js.map